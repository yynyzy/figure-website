import{h as t}from"./moment-a9aaa855.js";import{d as A,s as F,r as s,y as j,v as E,e as T,n as W,c as l,a as d,f as o,w as Y,x,g as b,m as B,t as i,q as G,F as H,i as J,o as c,k as v,_ as K}from"./index-3b82e300.js";import{Y as O}from"./Yixiv-30bec923.js";import{p as Q}from"./pictureBox-6463618b.js";import{n as U}from"./noWorks-aa541e5e.js";const X={class:"wrapper"},Z={class:"actions"},ee={class:"modes-content"},te={class:"filters"},ae={key:0,class:"date-btn",style:{"margin-right":"15px"}},se={key:1,class:"date-btn",style:{"margin-right":"15px"}},oe={class:"current-date"},ne={class:"date-btn",style:{"margin-right":"15px"}},re={class:"illust-box"},le=["textContent"],ie={key:0,class:"illust-content"},ce={key:1,class:"not-found"},ue={class:"pagination"},de=30,me=A({__name:"ranking",setup(Ye){const w=F(),u={title:"#排行榜",lastDay:"上一日",nextDay:"下一日",daily:"今日",weekly:"本周",monthly:"本月",new:"最新"},g=s(!1),{setNavigationBarActiveIndex:L}=j();L(2);const _=s("daily"),m=s(0),P=e=>{_.value=e,e==="daily"?m.value=0:e==="weekly"?m.value=1:m.value=2},D=t().format("YYYYMMDD"),y=s(""),n=s(""),p=s(""),M=s(""),C=e=>{switch(e?(n.value=t(e).format("YYYYMMDD"),p.value=t(e).subtract(1,"days").format("YYYYMMDD"),M.value=t(e).add(1,"days").format("YYYYMMDD")):(n.value=t().format("YYYYMMDD"),p.value=t().subtract(1,"days").format("YYYYMMDD"),M.value=t().add(1,"days").format("YYYYMMDD")),_.value){case"daily":y.value=e?t(e).format("YYYY年MM月DD日"):t().format("YYYY年MM月DD日");break;case"weekly":y.value=e?`${t(e).subtract(1,"weeks").format("YYYY年MM月DD日")} - ${t(e).format("YYYY年MM月DD日")}`:`${t().subtract(1,"weeks").format("YYYY年MM月DD日")} - ${t().format("YYYY年MM月DD日")}`;break;case"monthly":y.value=e?`${t(e).subtract(1,"months").format("YYYY年MM月DD日")} - ${t(e).format("YYYY年MM月DD日")}`:`${t().subtract(1,"months").format("YYYY年MM月DD日")} - ${t().format("YYYY年MM月DD日")}`;break;default:y.value=e?t(e).format("YYYY年MM月DD日"):t().format("YYYY年MM月DD日");break}},q=s(0),z=e=>{let a=0;e==="weekly"&&(a=1),e==="monthly"&&(a=2),q.value=a},h=s([]),N=async()=>{const e={type:q.value,ranking_date:n.value,offset:k.value,limit:30};g.value=!0;try{const{count:a,rows:r}=await O.getRankingList(e);h.value=r.map(f=>(f.regular_url=f.regular_url+"?x-oss-process=image/resize,w_450",f)),$.value=a,g.value=!1}catch{}},k=s(1),$=s(0),I=e=>{k.value=e,N()};return E(()=>w.query,()=>{const{date:e,mode:a}=w.query;a&&(P(a),z(a)),e?C(e):C(),N()},{immediate:!0,deep:!0}),(e,a)=>{const r=T("router-link"),f=T("el-pagination"),R=W("loading");return c(),l("section",X,[d("div",Z,[d("div",ee,[o(r,{class:x(["mode-btn",{active:m.value===0}]),to:{name:"",query:{date:n.value,mode:"daily"}}},{default:Y(()=>[v(i(u.daily),1)]),_:1},8,["class","to"]),o(r,{class:x(["mode-btn",{active:m.value===1}]),to:{name:"",query:{date:n.value,mode:"weekly"}}},{default:Y(()=>[v(i(u.weekly),1)]),_:1},8,["class","to"]),o(r,{class:x(["mode-btn",{active:m.value===2}]),to:{name:"",query:{date:n.value,mode:"monthly"}}},{default:Y(()=>[v(i(u.monthly),1)]),_:1},8,["class","to"])]),d("div",te,[Number(n.value)<Number(b(D))?(c(),l("div",ae,[o(r,{to:{name:"",query:{date:M.value,mode:_.value}}},{default:Y(()=>[v(i(u.nextDay),1)]),_:1},8,["to"])])):B("",!0),Number(n.value)<Number(b(D))?(c(),l("div",se,[o(r,{to:{name:"",query:{date:b(D),mode:_.value}}},{default:Y(()=>[v(i(u.new),1)]),_:1},8,["to"])])):B("",!0),d("div",oe,i(y.value),1),d("div",ne,[o(r,{to:{name:"",query:{date:p.value,mode:_.value}}},{default:Y(()=>[v(i(u.lastDay),1)]),_:1},8,["to"])])])]),G((c(),l("div",re,[d("h2",{class:"title",textContent:i(u.title)},null,8,le),h.value.length?(c(),l("ul",ie,[(c(!0),l(H,null,J(h.value,(S,V)=>(c(),l("li",{class:"illust",key:V},[o(Q,{item:S,"picture-height":258,"picture-width":225},null,8,["item"])]))),128))])):(c(),l("div",ce,[o(U)]))])),[[R,g.value]]),d("div",ue,[o(f,{style:{justifyContent:"center"},background:"",layout:"prev, pager, next","current-page":k.value,total:$.value,"page-size":de,onCurrentChange:I},null,8,["current-page","total"])])])}}});const De=K(me,[["__scopeId","data-v-493cee4f"]]);export{De as default};
